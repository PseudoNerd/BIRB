<!doctype html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <meta name="description" content="">
      <meta name="author" content="">
      <link rel="icon" href="">
      <title>BIRB - NDN</title>
      <style>
         /* Show it's not fixed to the top */
         body {
         min-height: 75rem;
         }
      </style>
      <!-- Insert this line above script imports  -->
      <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
      <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.min.css'>
      <link rel='stylesheet prefetch' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css'>
      <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/octicons/4.4.0/font/octicons.min.css'>
      <!-- Custom css-->
      <link rel="stylesheet" href="./css/style.css">
      <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
      <script src='https://npmcdn.com/tether@1.2.4/dist/js/tether.min.js'></script>
      <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
      <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/js/bootstrap.min.js'></script>
      <!-- Insert this line after script imports -->
      <script type="text/javascript" src="./user_data/birb.js"></script>
      <script type="text/javascript" src="./lib/user_management.js"></script>
      <script>if (window.module) module = window.module;</script>
   </head>
   <body>
      <!--Navigation bar-->
      <div id="nav-placeholder">
      </div>
      <script>
         $(function(){
           $("#nav-placeholder").load("navbar.html");
         });
      </script>
      <!--end of Navigation bar-->
      <div class="container">
      <h4 class="text-center">Welcom to BIRB </h4>
        <p class="text-center">A Distributed Social Media Application</p>
      <br />
      <div class="jumbotron">
         <div class="row">
            <div class="col-md-3">
               <div class="card" style="width: 0rem"  >
               </div>
            </div>
            <div class="col-md-6 col-md-offset-3">
               <div class="panel panel-login">
                  <div class="panel-heading">
                     <div class="row">
                        <!-- <div class="col-md-6 col-sm-6">
                           <a href="#" class="active" id="login-form-link">Login</a>
                        </div> -->
                        <div class="col-md-6 col-sm-6 col-xs-6">
                           <a href="#" id="register-form-link">Register</a>
                        </div>
                     </div>
                     <hr>
                  </div>
                  <div class="panel-body">
                     <div class="row">
                        <div class="col-lg-12">
                           <form id="login-form" action="" method="post" role="form" style="display: block;">
                              <div class="form-group">
                                 <input type="text" name="username" id="username" tabindex="1" class="form-control" placeholder="Username" value="" required>
                              </div>
                              <!-- <div class="form-group text-center">
                                 <input type="checkbox" tabindex="3" class="" name="remember" id="remember">
                                 <label for="remember"> Remember Me</label>
                              </div> -->
                              <div class="form-group">
                                 <div class="row">
                                    <div class="col-sm-6 col-sm-offset-3">
                                       <input type="submit" name="login-submit" id="login-submit" tabindex="4" class="form-control btn btn-login" value="Log In">
                                    </div>
                                 </div>
                              </div>
                           </form>
                           <form id="register-form" action="http://75.65.50.70/birb_db/data_handler.php" method="post" role="form" style="display: none;">
                              <div class="form-group">
                                 <input type="text" name="username" id="username" tabindex="1" class="form-control" placeholder="Username" value="" required>
                              </div>
                              <div class="form-group">
                                 <div class="row">
                                    <div class="col-sm-6 col-sm-offset-3">
                                       <input type="submit" name="register-submit" id="register-submit" tabindex="4" class="form-control btn btn-register" value="Register Now" required>
                                    </div>
                                 </div>
                              </div>
                           </form>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="col-md-3">
            </div>
         </div>
      </div>
      <script type="text/javascript">
         $(function() {

             $('#login-form-link').click(function(e) {
             $("#login-form").delay(100).fadeIn(100);
             $("#register-form").fadeOut(100);
             $('#register-form-link').removeClass('active');
             $(this).addClass('active');
             e.preventDefault();
           });
           $('#register-form-link').click(function(e) {
             $("#register-form").delay(100).fadeIn(100);
             $("#login-form").fadeOut(100);
             $('#login-form-link').removeClass('active');
             $(this).addClass('active');
             e.preventDefault();
           });

         });

         // this is the id of the form
         $("#register-form").submit(function(e) {

            /*
              before registering the uesr to the application, a few things should be checked
              1. check if a local user already exist or not
              2. check if the username is available or not
              note that, local user's table will start from L_username, and the followee table
              will start from F_username
            */
             var form = $(this);
             var url = form.attr('action');
             var username = form.serializeArray()[0].value;


             checkUniqueness(username).then(function(result){
               if (result){
                 console.log("Username already taken, please try again!!")
               }
               else
               {
                 console.log("Good Job");
                 // $.ajax({
                 //      type: "POST",
                 //      url: url,
                 //      data: form.serialize(), // serializes the form's elements.
                 //      success: function(data)
                 //        {
                 //          // if a uesr is logged in successfully, crete a json.table to store his data
                 //          // const birb = require('./user_data/birb.js'); //this will create a table for the user using username
                 createUser(username, 'L'); //flag L indicates Local user, while F indicates followee
                 //          window.location.href="index.html";
                 //          $("#content").append(data);
                 //        }
                 //      });
               }
             });
             e.preventDefault(); // avoid to execute the actual submit of the form.
         });

      </script>
   </body>
</html>
